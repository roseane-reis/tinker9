<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tinker9: Unit Tests</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tinker9<span id="projectnumber">&#160;d4dfb2d (Sun Mar 26 21:17:44 2023 -0700)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Unit Tests</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:classtinker_1_1_test_file"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#classtinker_1_1_test_file">tinker::TestFile</a></td></tr>
<tr class="memdesc:classtinker_1_1_test_file"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a file to disk in its constructor and removes the file in its destructor, unless the file is set to be kept.  <a href="group__test.html#classtinker_1_1_test_file">More...</a><br /></td></tr>
<tr class="separator:classtinker_1_1_test_file"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:classtinker_1_1_test_remove_file_on_exit"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#classtinker_1_1_test_remove_file_on_exit">tinker::TestRemoveFileOnExit</a></td></tr>
<tr class="memdesc:classtinker_1_1_test_remove_file_on_exit"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the file in its destructor as necessary.  <a href="group__test.html#classtinker_1_1_test_remove_file_on_exit">More...</a><br /></td></tr>
<tr class="separator:classtinker_1_1_test_remove_file_on_exit"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:classtinker_1_1_test_reference"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#classtinker_1_1_test_reference">tinker::TestReference</a></td></tr>
<tr class="memdesc:classtinker_1_1_test_reference"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads reference values from a text file.  <a href="group__test.html#classtinker_1_1_test_reference">More...</a><br /></td></tr>
<tr class="separator:classtinker_1_1_test_reference"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga07b230adc56d9874f252466b635d99d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga07b230adc56d9874f252466b635d99d0">COMPARE_INTS</a>(i1,  refi)&#160;&#160;&#160;REQUIRE(i1 == refi)</td></tr>
<tr class="memdesc:ga07b230adc56d9874f252466b635d99d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares two integers.  <a href="group__test.html#ga07b230adc56d9874f252466b635d99d0">More...</a><br /></td></tr>
<tr class="separator:ga07b230adc56d9874f252466b635d99d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6961bd46a5ddd80398602e22e694535c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga6961bd46a5ddd80398602e22e694535c">COMPARE_INTS_EPS</a>(i1,  refi,  epsi)</td></tr>
<tr class="memdesc:ga6961bd46a5ddd80398602e22e694535c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Approximately compares two integers.  <a href="group__test.html#ga6961bd46a5ddd80398602e22e694535c">More...</a><br /></td></tr>
<tr class="separator:ga6961bd46a5ddd80398602e22e694535c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa82f04925c4d16ca5aaee6671dbfa85a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#gaa82f04925c4d16ca5aaee6671dbfa85a">COMPARE_REALS</a>(v1,  refv,  eps)&#160;&#160;&#160;REQUIRE(v1 == Approx(refv).margin(eps))</td></tr>
<tr class="memdesc:gaa82f04925c4d16ca5aaee6671dbfa85a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares two floating-point numbers with a margin of error.  <a href="group__test.html#gaa82f04925c4d16ca5aaee6671dbfa85a">More...</a><br /></td></tr>
<tr class="separator:gaa82f04925c4d16ca5aaee6671dbfa85a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae5b7fba502059f9183a9e514dfbb1723"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#gae5b7fba502059f9183a9e514dfbb1723">COMPARE_ENERGY</a>(gpuptr,  ref_eng,  eps)</td></tr>
<tr class="memdesc:gae5b7fba502059f9183a9e514dfbb1723"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduces the energy from the energy buffer and compares to the reference value with a margin of error.  <a href="group__test.html#gae5b7fba502059f9183a9e514dfbb1723">More...</a><br /></td></tr>
<tr class="separator:gae5b7fba502059f9183a9e514dfbb1723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga059d50f2ecb9a98db35cf11f62a21249"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga059d50f2ecb9a98db35cf11f62a21249">COMPARE_COUNT</a>(gpuptr,  ref_count)</td></tr>
<tr class="memdesc:ga059d50f2ecb9a98db35cf11f62a21249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduces the number of interactions from the count buffer and compares to the reference value.  <a href="group__test.html#ga059d50f2ecb9a98db35cf11f62a21249">More...</a><br /></td></tr>
<tr class="separator:ga059d50f2ecb9a98db35cf11f62a21249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e97d3c54989336d977a3c429a71c319"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga4e97d3c54989336d977a3c429a71c319">COMPARE_VIR9</a>(vir1,  ref_v,  eps)</td></tr>
<tr class="memdesc:ga4e97d3c54989336d977a3c429a71c319"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares a virial tensor to the reference values with a margin of error.  <a href="group__test.html#ga4e97d3c54989336d977a3c429a71c319">More...</a><br /></td></tr>
<tr class="separator:ga4e97d3c54989336d977a3c429a71c319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga91e273c825b35ca762018f3763c9fd04"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga91e273c825b35ca762018f3763c9fd04">COMPARE_VIR</a>(gpuptr,  ref_v,  eps)</td></tr>
<tr class="memdesc:ga91e273c825b35ca762018f3763c9fd04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduces a virial tensor from a virial buffer and compares to the reference values with a margin of error.  <a href="group__test.html#ga91e273c825b35ca762018f3763c9fd04">More...</a><br /></td></tr>
<tr class="separator:ga91e273c825b35ca762018f3763c9fd04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69e86dfc28af6d0e1df671cedbac5e2c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga69e86dfc28af6d0e1df671cedbac5e2c">COMPARE_VIR2</a>(gpuptr,  gpuptr2,  ref_v,  eps)</td></tr>
<tr class="memdesc:ga69e86dfc28af6d0e1df671cedbac5e2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduces two virial tensors from two virial buffers and compares the sum to the reference with a margin of error.  <a href="group__test.html#ga69e86dfc28af6d0e1df671cedbac5e2c">More...</a><br /></td></tr>
<tr class="separator:ga69e86dfc28af6d0e1df671cedbac5e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad3a3e60271e184f6ce15d90c88e9517a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#gad3a3e60271e184f6ce15d90c88e9517a">COMPARE_GRADIENT</a>(ref_grad,  eps)&#160;&#160;&#160;<a class="el" href="group__test.html#gad5eab462c8de2d5f2663b12570b357f0">COMPARE_GRADIENT2</a>(ref_grad, eps, [](int, int) { return true; })</td></tr>
<tr class="memdesc:gad3a3e60271e184f6ce15d90c88e9517a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies out gradients from device to host and compares to the reference values with a margin of error.  <a href="group__test.html#gad3a3e60271e184f6ce15d90c88e9517a">More...</a><br /></td></tr>
<tr class="separator:gad3a3e60271e184f6ce15d90c88e9517a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad5eab462c8de2d5f2663b12570b357f0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#gad5eab462c8de2d5f2663b12570b357f0">COMPARE_GRADIENT2</a>(ref_grad,  eps,  check_ij)</td></tr>
<tr class="memdesc:gad5eab462c8de2d5f2663b12570b357f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares the flitered gradients[i][j] components.  <a href="group__test.html#gad5eab462c8de2d5f2663b12570b357f0">More...</a><br /></td></tr>
<tr class="separator:gad5eab462c8de2d5f2663b12570b357f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga398ae1a71c38a28e1922c047e96aaa86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga398ae1a71c38a28e1922c047e96aaa86">tinker::testGetEps</a> (double epsSingle, double epsDouble)</td></tr>
<tr class="memdesc:ga398ae1a71c38a28e1922c047e96aaa86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns tolerance eps depending on the predefined floating-point precision.  <a href="group__test.html#ga398ae1a71c38a28e1922c047e96aaa86">More...</a><br /></td></tr>
<tr class="separator:ga398ae1a71c38a28e1922c047e96aaa86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2e2e1d17176d8956cc393c2e3f629ab8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga2e2e1d17176d8956cc393c2e3f629ab8">tinker::testBeginWithArgs</a> (int argc, const char **argv)</td></tr>
<tr class="memdesc:ga2e2e1d17176d8956cc393c2e3f629ab8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the test.  <a href="group__test.html#ga2e2e1d17176d8956cc393c2e3f629ab8">More...</a><br /></td></tr>
<tr class="separator:ga2e2e1d17176d8956cc393c2e3f629ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4fbe121cde1c7d8d911aaae030276119"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ga4fbe121cde1c7d8d911aaae030276119">tinker::testEnd</a> ()</td></tr>
<tr class="memdesc:ga4fbe121cde1c7d8d911aaae030276119"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ends the test.  <a href="group__test.html#ga4fbe121cde1c7d8d911aaae030276119">More...</a><br /></td></tr>
<tr class="separator:ga4fbe121cde1c7d8d911aaae030276119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe8c25e3bc350ef8b353158181c9788b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#gabe8c25e3bc350ef8b353158181c9788b">tinker::testMdInit</a> (double t=0, double atm=0)</td></tr>
<tr class="memdesc:gabe8c25e3bc350ef8b353158181c9788b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes MD in the test.  <a href="group__test.html#gabe8c25e3bc350ef8b353158181c9788b">More...</a><br /></td></tr>
<tr class="separator:gabe8c25e3bc350ef8b353158181c9788b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<hr/><h2 class="groupheader">Class Documentation</h2>
<a name="classtinker_1_1_test_file" id="classtinker_1_1_test_file"></a>
<h2 class="memtitle"><span class="permalink"><a href="#classtinker_1_1_test_file">&#9670;&#160;</a></span>tinker::TestFile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class tinker::TestFile</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >Writes a file to disk in its constructor and removes the file in its destructor, unless the file is set to be kept. </p>
</div><table class="memberdecls">
<tr><td colspan="2"><h3>Public Member Functions</h3></td></tr>
<tr class="memitem:a0627af3d4170d0aa72373c3c3c421460"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a0627af3d4170d0aa72373c3c3c421460">TestFile</a> (std::string src, std::string dst=&quot;&quot;, std::string extra=&quot;&quot;)</td></tr>
<tr class="memdesc:a0627af3d4170d0aa72373c3c3c421460"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies file from source to destination with optional extra content appended to the new copy.  <a href="group__test.html#a0627af3d4170d0aa72373c3c3c421460">More...</a><br /></td></tr>
<tr class="separator:a0627af3d4170d0aa72373c3c3c421460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45292591a75c41b6d2bbaa47e93653f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ae45292591a75c41b6d2bbaa47e93653f">~TestFile</a> ()</td></tr>
<tr class="memdesc:ae45292591a75c41b6d2bbaa47e93653f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the file on disk on exit.  <a href="group__test.html#ae45292591a75c41b6d2bbaa47e93653f">More...</a><br /></td></tr>
<tr class="separator:ae45292591a75c41b6d2bbaa47e93653f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0a169d64b79c106d335d0088d9cbe8c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#ad0a169d64b79c106d335d0088d9cbe8c">__keep</a> ()</td></tr>
<tr class="memdesc:ad0a169d64b79c106d335d0088d9cbe8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prevents the file from being deleted.  <a href="group__test.html#ad0a169d64b79c106d335d0088d9cbe8c">More...</a><br /></td></tr>
<tr class="separator:ad0a169d64b79c106d335d0088d9cbe8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h4 class="groupheader">Constructor &amp; Destructor Documentation</h4>
<a id="a0627af3d4170d0aa72373c3c3c421460" name="a0627af3d4170d0aa72373c3c3c421460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0627af3d4170d0aa72373c3c3c421460">&#9670;&#160;</a></span>TestFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tinker::TestFile::TestFile </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>dst</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>extra</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies file from source to destination with optional extra content appended to the new copy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Path to the source file. If empty, <code>extra</code> will be written to <code>dst</code> which must be a valid path for the new file.</td></tr>
    <tr><td class="paramname">dst</td><td>Path to the new file. If empty, the source file is copied to the current working directory.</td></tr>
    <tr><td class="paramname">extra</td><td>Optional extra content. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae45292591a75c41b6d2bbaa47e93653f" name="ae45292591a75c41b6d2bbaa47e93653f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae45292591a75c41b6d2bbaa47e93653f">&#9670;&#160;</a></span>~TestFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tinker::TestFile::~TestFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes the file on disk on exit. </p>

</div>
</div>
<h4 class="groupheader">Member Function Documentation</h4>
<a id="ad0a169d64b79c106d335d0088d9cbe8c" name="ad0a169d64b79c106d335d0088d9cbe8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0a169d64b79c106d335d0088d9cbe8c">&#9670;&#160;</a></span>__keep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tinker::TestFile::__keep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prevents the file from being deleted. </p>

</div>
</div>

</div>
</div>
<a name="classtinker_1_1_test_remove_file_on_exit" id="classtinker_1_1_test_remove_file_on_exit"></a>
<h2 class="memtitle"><span class="permalink"><a href="#classtinker_1_1_test_remove_file_on_exit">&#9670;&#160;</a></span>tinker::TestRemoveFileOnExit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class tinker::TestRemoveFileOnExit</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >Removes the file in its destructor as necessary. </p>
</div><table class="memberdecls">
<tr><td colspan="2"><h3>Public Member Functions</h3></td></tr>
<tr class="memitem:a7b9280fefb9dfeaa208cdd342761e404"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a7b9280fefb9dfeaa208cdd342761e404">TestRemoveFileOnExit</a> (std::string fileToDelete)</td></tr>
<tr class="memdesc:a7b9280fefb9dfeaa208cdd342761e404"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filename.  <a href="group__test.html#a7b9280fefb9dfeaa208cdd342761e404">More...</a><br /></td></tr>
<tr class="separator:a7b9280fefb9dfeaa208cdd342761e404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a097f7aabf439b709dc46d28a54c880c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a097f7aabf439b709dc46d28a54c880c3">~TestRemoveFileOnExit</a> ()</td></tr>
<tr class="memdesc:a097f7aabf439b709dc46d28a54c880c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the file in the destructor.  <a href="group__test.html#a097f7aabf439b709dc46d28a54c880c3">More...</a><br /></td></tr>
<tr class="separator:a097f7aabf439b709dc46d28a54c880c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h4 class="groupheader">Constructor &amp; Destructor Documentation</h4>
<a id="a7b9280fefb9dfeaa208cdd342761e404" name="a7b9280fefb9dfeaa208cdd342761e404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b9280fefb9dfeaa208cdd342761e404">&#9670;&#160;</a></span>TestRemoveFileOnExit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tinker::TestRemoveFileOnExit::TestRemoveFileOnExit </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fileToDelete</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Filename. </p>

</div>
</div>
<a id="a097f7aabf439b709dc46d28a54c880c3" name="a097f7aabf439b709dc46d28a54c880c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a097f7aabf439b709dc46d28a54c880c3">&#9670;&#160;</a></span>~TestRemoveFileOnExit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tinker::TestRemoveFileOnExit::~TestRemoveFileOnExit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes the file in the destructor. </p>

</div>
</div>

</div>
</div>
<a name="classtinker_1_1_test_reference" id="classtinker_1_1_test_reference"></a>
<h2 class="memtitle"><span class="permalink"><a href="#classtinker_1_1_test_reference">&#9670;&#160;</a></span>tinker::TestReference</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class tinker::TestReference</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >Reads reference values from a text file. </p>
</div><table class="memberdecls">
<tr><td colspan="2"><h3>Public Member Functions</h3></td></tr>
<tr class="memitem:a32004914b22d252b346f28b56f83e817"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a32004914b22d252b346f28b56f83e817">~TestReference</a> ()</td></tr>
<tr class="separator:a32004914b22d252b346f28b56f83e817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a964a5c419abdbc5eb709840295f2e8de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a964a5c419abdbc5eb709840295f2e8de">TestReference</a> (std::string pathToRefFile)</td></tr>
<tr class="separator:a964a5c419abdbc5eb709840295f2e8de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ddf2d1a8b40ec26fcc8d13a8ddecfc3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a3ddf2d1a8b40ec26fcc8d13a8ddecfc3">getCount</a> () const</td></tr>
<tr class="separator:a3ddf2d1a8b40ec26fcc8d13a8ddecfc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bb52694b3e799445cdae9c996fcda30"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a2bb52694b3e799445cdae9c996fcda30">getEnergy</a> () const</td></tr>
<tr class="separator:a2bb52694b3e799445cdae9c996fcda30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adca97e4ec6c270eac8a83b28d55c30f8"><td class="memItemLeft" align="right" valign="top">const double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#adca97e4ec6c270eac8a83b28d55c30f8">getVirial</a> () const)[3]</td></tr>
<tr class="separator:adca97e4ec6c270eac8a83b28d55c30f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85a35b6880a9e36d1f96b2c11c24fb1c"><td class="memItemLeft" align="right" valign="top">const double(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a85a35b6880a9e36d1f96b2c11c24fb1c">getGradient</a> () const)[3]</td></tr>
<tr class="separator:a85a35b6880a9e36d1f96b2c11c24fb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d68d8453bda02ed27371e139387526e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__test.html#a0d68d8453bda02ed27371e139387526e">getEnergyCountByName</a> (std::string name, double &amp;<a class="el" href="group__egv.html#ga6de3f41e1e5a4280a6fd8f9edce1fdda">energy</a>, int &amp;count)</td></tr>
<tr class="separator:a0d68d8453bda02ed27371e139387526e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h4 class="groupheader">Constructor &amp; Destructor Documentation</h4>
<a id="a32004914b22d252b346f28b56f83e817" name="a32004914b22d252b346f28b56f83e817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32004914b22d252b346f28b56f83e817">&#9670;&#160;</a></span>~TestReference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tinker::TestReference::~TestReference </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a964a5c419abdbc5eb709840295f2e8de" name="a964a5c419abdbc5eb709840295f2e8de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a964a5c419abdbc5eb709840295f2e8de">&#9670;&#160;</a></span>TestReference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tinker::TestReference::TestReference </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>pathToRefFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h4 class="groupheader">Member Function Documentation</h4>
<a id="a3ddf2d1a8b40ec26fcc8d13a8ddecfc3" name="a3ddf2d1a8b40ec26fcc8d13a8ddecfc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ddf2d1a8b40ec26fcc8d13a8ddecfc3">&#9670;&#160;</a></span>getCount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tinker::TestReference::getCount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2bb52694b3e799445cdae9c996fcda30" name="a2bb52694b3e799445cdae9c996fcda30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bb52694b3e799445cdae9c996fcda30">&#9670;&#160;</a></span>getEnergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tinker::TestReference::getEnergy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0d68d8453bda02ed27371e139387526e" name="a0d68d8453bda02ed27371e139387526e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d68d8453bda02ed27371e139387526e">&#9670;&#160;</a></span>getEnergyCountByName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tinker::TestReference::getEnergyCountByName </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a85a35b6880a9e36d1f96b2c11c24fb1c" name="a85a35b6880a9e36d1f96b2c11c24fb1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85a35b6880a9e36d1f96b2c11c24fb1c">&#9670;&#160;</a></span>getGradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double(* tinker::TestReference::getGradient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>)[3] const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adca97e4ec6c270eac8a83b28d55c30f8" name="adca97e4ec6c270eac8a83b28d55c30f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adca97e4ec6c270eac8a83b28d55c30f8">&#9670;&#160;</a></span>getVirial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double(* tinker::TestReference::getVirial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>)[3] const</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga059d50f2ecb9a98db35cf11f62a21249" name="ga059d50f2ecb9a98db35cf11f62a21249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga059d50f2ecb9a98db35cf11f62a21249">&#9670;&#160;</a></span>COMPARE_COUNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_COUNT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">gpuptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ref_count&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">   {                                     \</div>
<div class="line">      <span class="keywordtype">int</span> count = countReduce(gpuptr);   \</div>
<div class="line">      REQUIRE(count == ref_count);       \</div>
<div class="line">   }</div>
</div><!-- fragment -->
<p>Reduces the number of interactions from the count buffer and compares to the reference value. </p>

</div>
</div>
<a id="gae5b7fba502059f9183a9e514dfbb1723" name="gae5b7fba502059f9183a9e514dfbb1723"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae5b7fba502059f9183a9e514dfbb1723">&#9670;&#160;</a></span>COMPARE_ENERGY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_ENERGY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">gpuptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ref_eng, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">eps&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">   {                                               \</div>
<div class="line">      <span class="keywordtype">double</span> eng = energyReduce(gpuptr);           \</div>
<div class="line">      REQUIRE(eng == Approx(ref_eng).margin(eps)); \</div>
<div class="line">   }</div>
</div><!-- fragment -->
<p>Reduces the energy from the energy buffer and compares to the reference value with a margin of error. </p>

</div>
</div>
<a id="gad3a3e60271e184f6ce15d90c88e9517a" name="gad3a3e60271e184f6ce15d90c88e9517a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad3a3e60271e184f6ce15d90c88e9517a">&#9670;&#160;</a></span>COMPARE_GRADIENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_GRADIENT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ref_grad, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">eps&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__test.html#gad5eab462c8de2d5f2663b12570b357f0">COMPARE_GRADIENT2</a>(ref_grad, eps, [](int, int) { return true; })</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies out gradients from device to host and compares to the reference values with a margin of error. </p>

</div>
</div>
<a id="gad5eab462c8de2d5f2663b12570b357f0" name="gad5eab462c8de2d5f2663b12570b357f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad5eab462c8de2d5f2663b12570b357f0">&#9670;&#160;</a></span>COMPARE_GRADIENT2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_GRADIENT2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ref_grad, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">eps, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">check_ij&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">   {                                                                                  \</div>
<div class="line">      std::vector&lt;double&gt; gradx(n), grady(n), gradz(n);                               \</div>
<div class="line">      copyGradient(calc::grad, gradx.data(), grady.data(), gradz.data());             \</div>
<div class="line">      for (<span class="keywordtype">int</span> i = 0; i &lt; n; ++i) {                                                   \</div>
<div class="line">         if (check_ij(i, 0)) REQUIRE(gradx[i] == Approx(ref_grad[i][0]).margin(eps)); \</div>
<div class="line">         if (check_ij(i, 1)) REQUIRE(grady[i] == Approx(ref_grad[i][1]).margin(eps)); \</div>
<div class="line">         if (check_ij(i, 2)) REQUIRE(gradz[i] == Approx(ref_grad[i][2]).margin(eps)); \</div>
<div class="line">      }                                                                               \</div>
<div class="line">   }</div>
</div><!-- fragment -->
<p>Compares the flitered gradients[i][j] components. </p>

</div>
</div>
<a id="ga07b230adc56d9874f252466b635d99d0" name="ga07b230adc56d9874f252466b635d99d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga07b230adc56d9874f252466b635d99d0">&#9670;&#160;</a></span>COMPARE_INTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_INTS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">refi&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;REQUIRE(i1 == refi)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares two integers. </p>

</div>
</div>
<a id="ga6961bd46a5ddd80398602e22e694535c" name="ga6961bd46a5ddd80398602e22e694535c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6961bd46a5ddd80398602e22e694535c">&#9670;&#160;</a></span>COMPARE_INTS_EPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_INTS_EPS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">refi, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">epsi&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">   {                                     \</div>
<div class="line">      <span class="keywordtype">int</span> c1 = i1;                       \</div>
<div class="line">      <span class="keywordtype">int</span> r1 = refi;                     \</div>
<div class="line">      REQUIRE(r1 - epsi &lt;= c1);          \</div>
<div class="line">      REQUIRE(c1 &lt;= r1 + epsi);          \</div>
<div class="line">   }</div>
</div><!-- fragment -->
<p>Approximately compares two integers. </p>

</div>
</div>
<a id="gaa82f04925c4d16ca5aaee6671dbfa85a" name="gaa82f04925c4d16ca5aaee6671dbfa85a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa82f04925c4d16ca5aaee6671dbfa85a">&#9670;&#160;</a></span>COMPARE_REALS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_REALS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">v1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">refv, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">eps&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;REQUIRE(v1 == Approx(refv).margin(eps))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares two floating-point numbers with a margin of error. </p>

</div>
</div>
<a id="ga91e273c825b35ca762018f3763c9fd04" name="ga91e273c825b35ca762018f3763c9fd04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga91e273c825b35ca762018f3763c9fd04">&#9670;&#160;</a></span>COMPARE_VIR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_VIR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">gpuptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ref_v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">eps&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">   {                                                       \</div>
<div class="line">      virial_prec vir1[9];                                 \</div>
<div class="line">      virialReduce(vir1, gpuptr);                          \</div>
<div class="line">      REQUIRE(vir1[0] == Approx(ref_v[0][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[1] == Approx(ref_v[0][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[2] == Approx(ref_v[0][2]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[3] == Approx(ref_v[1][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[4] == Approx(ref_v[1][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[5] == Approx(ref_v[1][2]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[6] == Approx(ref_v[2][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[7] == Approx(ref_v[2][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[8] == Approx(ref_v[2][2]).margin(eps)); \</div>
<div class="line">   }</div>
</div><!-- fragment -->
<p>Reduces a virial tensor from a virial buffer and compares to the reference values with a margin of error. </p>

</div>
</div>
<a id="ga69e86dfc28af6d0e1df671cedbac5e2c" name="ga69e86dfc28af6d0e1df671cedbac5e2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga69e86dfc28af6d0e1df671cedbac5e2c">&#9670;&#160;</a></span>COMPARE_VIR2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_VIR2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">gpuptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">gpuptr2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ref_v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">eps&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">   {                                                                 \</div>
<div class="line">      virial_prec vir1[9], vir2[9];                                  \</div>
<div class="line">      virialReduce(vir1, gpuptr);                                    \</div>
<div class="line">      virialReduce(vir2, gpuptr2);                                   \</div>
<div class="line">      REQUIRE(vir1[0] + vir2[0] == Approx(ref_v[0][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[1] + vir2[1] == Approx(ref_v[0][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[2] + vir2[2] == Approx(ref_v[0][2]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[3] + vir2[3] == Approx(ref_v[1][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[4] + vir2[4] == Approx(ref_v[1][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[5] + vir2[5] == Approx(ref_v[1][2]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[6] + vir2[6] == Approx(ref_v[2][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[7] + vir2[7] == Approx(ref_v[2][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[8] + vir2[8] == Approx(ref_v[2][2]).margin(eps)); \</div>
<div class="line">   }</div>
</div><!-- fragment -->
<p>Reduces two virial tensors from two virial buffers and compares the sum to the reference with a margin of error. </p>

</div>
</div>
<a id="ga4e97d3c54989336d977a3c429a71c319" name="ga4e97d3c54989336d977a3c429a71c319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e97d3c54989336d977a3c429a71c319">&#9670;&#160;</a></span>COMPARE_VIR9</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMPARE_VIR9</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">vir1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ref_v, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">eps&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">   {                                                       \</div>
<div class="line">      REQUIRE(vir1[0] == Approx(ref_v[0][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[1] == Approx(ref_v[0][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[2] == Approx(ref_v[0][2]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[3] == Approx(ref_v[1][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[4] == Approx(ref_v[1][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[5] == Approx(ref_v[1][2]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[6] == Approx(ref_v[2][0]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[7] == Approx(ref_v[2][1]).margin(eps)); \</div>
<div class="line">      REQUIRE(vir1[8] == Approx(ref_v[2][2]).margin(eps)); \</div>
<div class="line">   }</div>
</div><!-- fragment -->
<p>Compares a virial tensor to the reference values with a margin of error. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga2e2e1d17176d8956cc393c2e3f629ab8" name="ga2e2e1d17176d8956cc393c2e3f629ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2e2e1d17176d8956cc393c2e3f629ab8">&#9670;&#160;</a></span>testBeginWithArgs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tinker::testBeginWithArgs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the test. </p>

</div>
</div>
<a id="ga4fbe121cde1c7d8d911aaae030276119" name="ga4fbe121cde1c7d8d911aaae030276119"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fbe121cde1c7d8d911aaae030276119">&#9670;&#160;</a></span>testEnd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tinker::testEnd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ends the test. </p>

</div>
</div>
<a id="ga398ae1a71c38a28e1922c047e96aaa86" name="ga398ae1a71c38a28e1922c047e96aaa86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga398ae1a71c38a28e1922c047e96aaa86">&#9670;&#160;</a></span>testGetEps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tinker::testGetEps </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsSingle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsDouble</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns tolerance eps depending on the predefined floating-point precision. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">epsSingle</td><td>Larger eps value for lower floating-point precision.</td></tr>
    <tr><td class="paramname">epsDouble</td><td>Smaller eps value for higher floating-point precision. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gabe8c25e3bc350ef8b353158181c9788b" name="gabe8c25e3bc350ef8b353158181c9788b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe8c25e3bc350ef8b353158181c9788b">&#9670;&#160;</a></span>testMdInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tinker::testMdInit </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>atm</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes MD in the test. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Temperature in Kelvin.</td></tr>
    <tr><td class="paramname">atm</td><td>Atmosphere in atm. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
